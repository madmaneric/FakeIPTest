from scapy.all import (send, IP, UDP)
flag = 1
print("Vesion 0.1")
print("此为测试版，仅支持基本的发送伪造源IP地址的行为，输入IP地址时务必输入掩码")
print("错误处理能力有限，出现处理不了的异常，即错即崩")
print("IP仅需前三位，末尾不要带'.'，源和目的端均使用UDP协议，端口均为1000，包长为1480字节")
print("接收端请用命令：tcpdump -i 网卡接口名称 -n udp port 1000 ，来查看是否收到数据包")
TargetIP = input("输入目标主机：")
while flag != 0:
    Test_IP_Pool = []
    IP_Source_Range = '0.0.0.0'
    try:
        IP_Source_Range = input("你想要测试的源IP地址范围,仅需要前三位(xxx.xxx.xxx.xxx):")
    except IndexError:
        print("输入有误")
    else:
        print("输入有误")
    i = 0
    while i < 256:
        IP_To_Append = IP_Source_Range + '.' + str(i)
        Test_IP_Pool.append(IP_To_Append)
        i += 1
    load="0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    for x in Test_IP_Pool:
        try:
            send(IP(src=x, dst=TargetIP) / UDP(sport=[1000], dport=[1000])/load)
        except OSError:
            print("输入有误···")
            break
        else:
            print("成功发送IP地址为 %s 的数据包" %(x))
    print("所有的数据包已生成并发送完毕！")
    print("若要退出请按Ctrl+C键")